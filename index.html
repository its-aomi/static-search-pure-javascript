<!DOCTYPE html>
<html>
  <head>
    <title>Static Search</title>
  </head>
  <body>
    <div class="container">
        <p style="font-weight:bold;">Search</p>
		<input type="text" id="search-input" placeholder="Search">
        <button type="submit">Search</button>
        <div id="search-results"></div>
    <script>

      // Made by Amitabh Borah : https://github.com/its-aomi/
      // Permission Granted for Modification and Personal Use, Must Include these two lines.

document.addEventListener('DOMContentLoaded', () => {
  const searchInput = document.getElementById('search-input');
  const submitButton = document.getElementById('submit');

  async function fetchAndParseTextFile() {
    const textFile = await fetchTextFile();
    const entries = textFile.match(/Title : (.*) \(URL:(.*)\)/g); // Extract all the entries using a regular expression
    const data = entries.map(entry => {
      const [, title, url] = entry.match(/Title : (.*) \(URL:(.*)\)/); // Extract the title and URL using a regular expression
      return { title, url };
    });
    return data;
  }

async function doSearch() {
  const data = await fetchAndParseTextFile();
  const searchTerm = searchInput.value; // The search term the user entered

  // Execute the search
  const searchResults = search(searchTerm, data);

  // Do something with the search results (e.g. display them on the page)
  displaySearchResults(searchResults, searchTerm);
}


  searchInput.addEventListener('input', doSearch);
  submitButton.addEventListener('click', doSearch);

  function search(searchTerm, data) {
    return data.filter(entry => {
      return entry.title.toLowerCase().includes(searchTerm.toLowerCase()) || entry.url.toLowerCase().includes(searchTerm.toLowerCase());
    });
  }

function displaySearchResults(results, searchTerm) {
  const searchResultsList = document.getElementById('search-results');

  // Clear the search results list
  searchResultsList.innerHTML = '';

  if (results.length > 0) {
    // Iterate through the search results and create an HTML element for each result
    for (const result of results) {
      const resultElement = document.createElement('div');
      // Highlight the search term in the title and URL
      const highlightedTitle = result.title.replace(new RegExp(searchTerm, 'gi'), '<mark>$&</mark>');
      const highlightedUrl = result.url.replace(new RegExp(searchTerm, 'gi'), '<mark>$&</mark>');
      resultElement.innerHTML = `<a href="${highlightedUrl}"><h2>${highlightedTitle}</h2></a>`;
      searchResultsList.appendChild(resultElement);
    }
  } else {
    // No results were found, so display a message
    const noResultsElement = document.createElement('div');
    noResultsElement.innerHTML = '<h2>No Results</h2>';
    searchResultsList.appendChild(noResultsElement);
  }
}

});

const textFileUrl = 'https://its-aomi.github.io/static-search-pure-javascript/search.txt'; // The URL of the text file

async function fetchTextFile() {
  const response = await fetch(textFileUrl);
  const text = await response.text();
  return text;
}
</script>
</body>
</html>
